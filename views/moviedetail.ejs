<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= movie.title %> - Details</title>
  <link rel="stylesheet" href="/css/movie.css">
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin:0; 
      padding:0; 
      background-image: url("/img/starry-night-sky_1048-11828.avif"); 
      background-attachment: fixed;   /* keep background static */
      background-size: cover;         /* fill screen */
      background-position: center;
      background-repeat: no-repeat;
      color: #fff;
    }
    .topnav {
      padding: 40px;
      background-color: rgb(0, 0, 10);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .topnav a {
      text-decoration: none;
      color: rgb(151, 210, 239);
      font-weight: bold;
      font-size: 1.2rem;
    }
    .topnav a:hover {
      color: rgb(20, 103, 103);
    }
    .container { 
      max-width:1000px; 
      margin:20px auto; 
      padding:20px; 
      background: rgba(1,2,18,0.9); 
      border-radius:8px; 
    }

    .movie-title {
      text-align: center;
      font-size: 3rem;
      margin-bottom: 30px;
      color: #1deded;
      word-break: break-word;
    }

    .movie-header { 
      display:flex; 
      gap:20px; 
      flex-wrap: wrap; 
      justify-content: center; 
      align-items: flex-start;
    }
    .movie-header img { width:350px; border-radius:8px; height:420px; padding-top: 30px; padding-bottom: -70px;}
    .movie-info { 
      flex:1; 
      display:flex; 
      flex-direction: column; 
      text-align: left; 
      color: #ddd;
      font-size: 1.5rem;
      min-height: 250px;
    }

    .tmdb-rating {
      text-align: left;
      font-size: 1.3rem;
      margin-top: 15px;
      color: #f5c518;
    }
    
    .reviews { margin-top:30px; }
    .reviews h3 { margin-bottom:10px; color:#f0f0f0; text-align:center; }
    .reviews ul { list-style:none; padding:0; }
    .reviews li { background: rgba(255,255,255,0.1); margin-bottom:10px; padding:10px; border-radius:5px; color:#fff; }

    .review-form { margin-top:30px; }
    .review-form h3 { text-align:center; color:#f0f0f0;margin-bottom: 25px; }
    .review-form input, .review-form textarea { width:100%; padding:8px; margin-bottom:10px; border-radius:5px; border:1px ; color:#fff;background:rgba(255,255,255,0.1) ;}
    .review-form button { padding:10px 20px; background: rgb(29, 51, 122); color:#fff; border:none; border-radius:5px; cursor:pointer; margin-top: 30px;}
    .review-form button:hover { background: rgb(20,103,103); }
  </style>
</head>
<body>

  <div class="topnav">
    <b><a href="/movie">Groovy Reviews</a></b>
  </div>

  <div class="container">
    <!-- Movie Title -->
    <div class="movie-title"><%= movie.title %></div>

    <!-- Movie Header -->
    <div class="movie-header">
      <img src="<%= movie.poster %>" alt="<%= movie.title %>">
      <div class="movie-info">
        <p><%= movie.description %></p>

        <% if (movie.rating) { %>
          <div class="tmdb-rating">⭐ TMDB Rating: <%= movie.rating %> / 10</div>
        <% } %>
        <% if (movie.releaseDate) { %>
          <div class="tmdb-rating"><strong>Release Date:</strong> <%= movie.releaseDate %></div>
        <% } %>
        <% if (movie.runtime) { %>
          <div class="tmdb-rating"><strong>Runtime:</strong> <%= movie.runtime %> mins</div>
        <% } %>
        <% if (movie.genres && movie.genres.length > 0) { %>
          <div class="tmdb-rating"><strong>Genres:</strong> <%= movie.genres.join(", ") %></div>
        <% } %>
        <% if (movie.cast && movie.cast.length > 0) { %>
          <div class="tmdb-rating"><strong>Cast:</strong> <%= movie.cast.join(", ") %></div>
        <% } %>
      </div>
    </div>

    <!-- Reviews Section -->
    <div class="reviews">
      <h3>Reviews</h3>
      <% if (reviews && reviews.length > 0) { %>
        <ul>
          <% reviews.forEach(r => { %>
            <li>
              <strong><%= r.user %> (<%= r.source %>):</strong>
              <%= r.text %>
              <% if (r.rating) { %> (⭐ <%= r.rating %>) <% } %>
            </li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>No reviews yet.</p>
      <% } %>
    </div>

    <!-- Review Form -->
    <div class="review-form">
      <h3>Leave a Review</h3>
      <form action="/review" method="POST">
        <input type="hidden" name="movieId" value="<%= movie.id %>">
        <input type="text" name="user" placeholder="Your name">
        <textarea name="text" placeholder="Write your review" required></textarea>
        <input type="number" name="rating" min="1" max="10" placeholder="Rating (1–10)">
        <button type="submit">Submit</button>
      </form>
    </div>

  </div>
</body>
</html>
